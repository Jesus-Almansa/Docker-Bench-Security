<!DOCTYPE html>
<html>
<head>
<title>Docker Bench Security Report</title>
</head>
<body>
<h1>Docker Bench Security Report</h1>
<p>Version: 1.6.0</p>
<p>Start Time: 1711552881</p>
<p>End Time: 1711552886</p>
<p>Total Checks: 117</p>
<p>Score: 10</p>
<h2>Test Results</h2>
<h3>Host Configuration</h3>
<ul>
<li>Ensure a separate partition for containers has been created (Automated): WARN</li>
<li>Ensure only trusted users are allowed to control Docker daemon (Automated): INFO</li>
<p>doubtfulusers: kali</p>
<li>Ensure auditing is configured for the Docker daemon (Automated): WARN</li>
<li>Ensure auditing is configured for Docker files and directories -/run/containerd (Automated): WARN</li>
<li>Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated): WARN</li>
<li>Ensure auditing is configured for Docker files and directories - /etc/docker (Automated): WARN</li>
<li>Ensure auditing is configured for Docker files and directories - docker.service (Automated): WARN</li>
<li>Ensure auditing is configured for Docker files and directories - containerd.sock (Automated): INFO</li>
<p>File not found</p>
<li>Ensure auditing is configured for Docker files and directories - docker.socket (Automated): WARN</li>
<li>Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated): WARN</li>
<li>Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated): INFO</li>
<p>File not found</p>
<li>1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated): WARN</li>
<li>Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated): INFO</li>
<p>File not found</p>
<li>Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated): WARN</li>
<li>Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated): WARN</li>
<li>Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated): WARN</li>
<li>Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated): WARN</li>
<li>Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated): WARN</li>
<li>Ensure the container host has been Hardened (Manual): INFO</li>
<li>Ensure that the version of Docker is up to date (Manual): INFO</li>
<p>Using 20.10.25+1</p>
</ul>
<h3>Docker daemon configuration</h3>
<ul>
<li>Run the Docker daemon as a non-root user, if possible (Manual): INFO</li>
<li>Ensure network traffic is restricted between containers on the default bridge (Scored): WARN</li>
<li>Ensure the logging level is set to 'info' (Scored): PASS</li>
<li>Ensure Docker is allowed to make changes to iptables (Scored): PASS</li>
<li>Ensure insecure registries are not used (Scored): PASS</li>
<li>Ensure aufs storage driver is not used (Scored): PASS</li>
<li>Ensure TLS authentication for Docker daemon is configured (Scored): INFO</li>
<p>Docker daemon not listening on TCP</p>
<li>Ensure the default ulimit is configured appropriately (Manual): INFO</li>
<p>Default ulimit doesn't appear to be set</p>
<li>Enable user namespace support (Scored): WARN</li>
<li>Ensure the default cgroup usage has been confirmed (Scored): PASS</li>
<li>Ensure base device size is not changed until needed (Scored): PASS</li>
<li>Ensure that authorization for Docker client commands is enabled (Scored): WARN</li>
<li>Ensure centralized and remote logging is configured (Scored): WARN</li>
<li>Ensure containers are restricted from acquiring new privileges (Scored): WARN</li>
<li>Ensure live restore is enabled (Scored): WARN</li>
<li>Ensure Userland Proxy is Disabled (Scored): WARN</li>
<li>Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual): PASS</li>
<li>Ensure that experimental features are not implemented in production (Scored): INFO</li>
</ul>
<h3>Docker daemon configuration files</h3>
<ul>
<li>Ensure that the docker.service file ownership is set to root:root (Automated): PASS</li>
<li>Ensure that docker.service file permissions are appropriately set (Automated): PASS</li>
<li>Ensure that docker.socket file ownership is set to root:root (Automated): PASS</li>
<li>Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated): PASS</li>
<li>Ensure that the /etc/docker directory ownership is set to root:root (Automated): PASS</li>
<li>Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated): PASS</li>
<li>Ensure that registry certificate file ownership is set to root:root (Automated): INFO</li>
<p>Directory not found</p>
<li>Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated): INFO</li>
<p>Directory not found</p>
<li>Ensure that TLS CA certificate file ownership is set to root:root (Automated): INFO</li>
<p>No TLS CA certificate found</p>
<li>Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated): INFO</li>
<p>No TLS CA certificate found</p>
<li>Ensure that Docker server certificate file ownership is set to root:root (Automated): INFO</li>
<p>No TLS Server certificate found</p>
<li>Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated): INFO</li>
<p>No TLS Server certificate found</p>
<li>Ensure that the Docker server certificate key file ownership is set to root:root (Automated): INFO</li>
<p>No TLS Key found</p>
<li>Ensure that the Docker server certificate key file permissions are set to 400 (Automated): INFO</li>
<p>No TLS Key found</p>
<li>Ensure that the Docker socket file ownership is set to root:docker (Automated): PASS</li>
<li>Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated): PASS</li>
<li>Ensure that the daemon.json file ownership is set to root:root (Automated): INFO</li>
<p>File not found</p>
<li>Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated): INFO</li>
<p>File not found</p>
<li>Ensure that the /etc/default/docker file ownership is set to root:root (Automated): PASS</li>
<li>Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated): PASS</li>
<li>Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated): INFO</li>
<p>File not found</p>
<li>Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated): INFO</li>
<p>File not found</p>
<li>Ensure that the Containerd socket file ownership is set to root:root (Automated): PASS</li>
<li>Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated): PASS</li>
</ul>
<h3>Container Images and Build File</h3>
<ul>
<li>Ensure that a user for the container has been created (Automated): WARN</li>
<p>running as root:  reverent_noyce nice_blackburn</p>
<li>Ensure that containers use only trusted base images (Manual): NOTE</li>
<li>Ensure that unnecessary packages are not installed in the container (Manual): NOTE</li>
<li>Ensure images are scanned and rebuilt to include security patches (Manual): NOTE</li>
<li>Ensure Content trust for Docker is Enabled (Automated): WARN</li>
<li>Ensure that HEALTHCHECK instructions have been added to container images (Automated): WARN</li>
<p>Images w/o HEALTHCHECK:  [docker:latest] [ubuntu:latest] [python:latest] [ghcr.io/osgeo/gdal:ubuntu-full-latest] [alpine:latest] 8ca4688f4f35 [hello-world:latest]</p>
<li>Ensure update instructions are not used alone in the Dockerfile (Manual): INFO</li>
<p>Update instructions found:  [python:latest]</p>
<li>Ensure setuid and setgid permissions are removed (Manual): NOTE</li>
<li>Ensure that COPY is used instead of ADD in Dockerfiles (Manual): INFO</li>
<p>Images using ADD:  [ubuntu:latest] [ghcr.io/osgeo/gdal:ubuntu-full-latest]</p>
<li>Ensure secrets are not stored in Dockerfiles (Manual): NOTE</li>
<li>Ensure only verified packages are installed (Manual): NOTE</li>
<li>Ensure all signed artifacts are validated (Manual): NOTE</li>
</ul>
<h3>Container Runtime</h3>
<ul>
<li>Ensure swarm mode is not Enabled, if not needed (Automated): PASS</li>
<li>Ensure that, if applicable, an AppArmor Profile is enabled (Automated): PASS</li>
<li>Ensure that, if applicable, SELinux security options are set (Automated): WARN</li>
<p>Containers with no SecurityOptions:  reverent_noyce nice_blackburn</p>
<li>Ensure that Linux kernel capabilities are restricted within containers (Automated): PASS</li>
<li>Ensure that privileged containers are not used (Automated): PASS</li>
<li>Ensure sensitive host system directories are not mounted on containers (Automated): PASS</li>
<li>Ensure sshd is not run within containers (Automated): PASS</li>
<li>Ensure privileged ports are not mapped within containers (Automated): PASS</li>
<li>Ensure that only needed ports are open on the container (Manual): PASS</li>
<li>Ensure that the host's network namespace is not shared (Automated): PASS</li>
<li>Ensure that the memory usage for containers is limited (Automated): WARN</li>
<p>Container running without memory restrictions:  reverent_noyce nice_blackburn</p>
<li>Ensure that CPU priority is set appropriately on containers (Automated): WARN</li>
<p>Containers running without CPU restrictions:  reverent_noyce nice_blackburn</p>
<li>Ensure that the container's root filesystem is mounted as read only (Automated): WARN</li>
<p>Containers running with root FS mounted R/W:  reverent_noyce nice_blackburn</p>
<li>Ensure that incoming container traffic is bound to a specific host interface (Automated): PASS</li>
<li>Ensure that the 'on-failure' container restart policy is set to '5' (Automated): PASS</li>
<li>Ensure that the host's process namespace is not shared (Automated): PASS</li>
<li>Ensure that the host's IPC namespace is not shared (Automated): PASS</li>
<li>Ensure that host devices are not directly exposed to containers (Manual): PASS</li>
<li>Ensure that the default ulimit is overwritten at runtime if needed (Manual): INFO</li>
<p>Containers with no default ulimit override:  reverent_noyce nice_blackburn</p>
<li>Ensure mount propagation mode is not set to shared (Automated): PASS</li>
<li>Ensure that the host's UTS namespace is not shared (Automated): PASS</li>
<li>Ensure the default seccomp profile is not Disabled (Automated): PASS</li>
<li>Ensure that docker exec commands are not used with the privileged option (Automated): NOTE</li>
<li>Ensure that docker exec commands are not used with the user=root option (Manual): NOTE</li>
<li>Ensure that cgroup usage is confirmed (Automated): PASS</li>
<li>Ensure that the container is restricted from acquiring additional privileges (Automated): WARN</li>
<p>Containers without restricted privileges:  reverent_noyce nice_blackburn</p>
<li>Ensure that container health is checked at runtime (Automated): WARN</li>
<p>Containers without health check:  reverent_noyce nice_blackburn</p>
<li>Ensure that Docker commands always make use of the latest version of their image (Manual): INFO</li>
<li>Ensure that the PIDs cgroup limit is used (Automated): WARN</li>
<p>Containers without PIDs cgroup limit:  reverent_noyce nice_blackburn</p>
<li>Ensure that Docker's default bridge 'docker0' is not used (Manual): INFO</li>
<p>Containers using docker0 network:  3031a689826da0bfe570e50d0752ae08f4230ed94cf14099a4fc46c4e7a10755:reverent_noyce e71ad4feabcef64c1de640af5011b7686502e1dfac69fefa0e7b6f50d2d59cf0:nice_blackburn</p>
<li>Ensure that the host's user namespaces are not shared (Automated): PASS</li>
<li>Ensure that the Docker socket is not mounted inside any containers (Automated): PASS</li>
</ul>
<h3>Docker Security Operations</h3>
<ul>
<li>Ensure that image sprawl is avoided (Manual): INFO</li>
<p>7 active/8 in use</p>
<li>Ensure that container sprawl is avoided (Manual): INFO</li>
<p>7 total/2 running</p>
</ul>
<h3>Docker Swarm Configuration</h3>
<ul>
<li>Ensure that the minimum number of manager nodes have been created in a swarm (Automated): PASS</li>
<li>Ensure that swarm services are bound to a specific host interface (Automated): PASS</li>
<li>Ensure that all Docker swarm overlay networks are encrypted (Automated): PASS</li>
<li>Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual): PASS</li>
<li>Ensure that swarm manager is run in auto-lock mode (Automated): PASS</li>
<li>Ensure that the swarm manager auto-lock key is rotated periodically (Manual): PASS</li>
<li>Ensure that node certificates are rotated as appropriate (Manual): PASS</li>
<li>Ensure that CA certificates are rotated as appropriate (Manual): PASS</li>
<li>Ensure that management plane traffic is separated from data plane traffic (Manual): PASS</li>
</ul>
</body>
</html>